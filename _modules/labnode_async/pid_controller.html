<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>labnode_async.pid_controller &#8212; labnode_async v0.16.4 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/nature.css?v=279e0f84" />
    <script src="../../_static/documentation_options.js?v=81998473"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">labnode_async v0.16.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">labnode_async.pid_controller</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for labnode_async.pid_controller</h1><div class="highlight"><pre>
<span></span><span class="c1"># ##### BEGIN GPL LICENSE BLOCK #####</span>
<span class="c1">#</span>
<span class="c1"># Copyright (C) 2022  Patrick Baus</span>
<span class="c1">#</span>
<span class="c1"># This program is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU General Public License for more details.</span>

<span class="c1"># You should have received a copy of the GNU General Public License</span>
<span class="c1"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="c1">#</span>
<span class="c1"># ##### END GPL LICENSE BLOCK #####</span>
<span class="sd">&quot;&quot;&quot;The labnode PID controller driver&quot;&quot;&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">decimal</span><span class="w"> </span><span class="kn">import</span> <span class="n">Decimal</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">unique</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Callable</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">uuid</span><span class="w"> </span><span class="kn">import</span> <span class="n">UUID</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.devices</span><span class="w"> </span><span class="kn">import</span> <span class="n">DeviceIdentifier</span><span class="p">,</span> <span class="n">ErrorCode</span><span class="p">,</span> <span class="n">PidFunctionID</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.errors</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">FunctionNotImplementedError</span><span class="p">,</span>
    <span class="n">InvalidCommandError</span><span class="p">,</span>
    <span class="n">InvalidFormatError</span><span class="p">,</span>
    <span class="n">InvalidModeError</span><span class="p">,</span>
    <span class="n">InvalidReplyError</span><span class="p">,</span>
    <span class="n">PidNotInitializedError</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.labnode</span><span class="w"> </span><span class="kn">import</span> <span class="n">Labnode</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.connection</span><span class="w"> </span><span class="kn">import</span> <span class="n">Connection</span>


<div class="viewcode-block" id="FeedbackDirection">
<a class="viewcode-back" href="../../modules.html#labnode_async.FeedbackDirection">[docs]</a>
<span class="nd">@unique</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FeedbackDirection</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The sign of the feedback action of the PID controller. A positive direction means, that a positive disturbance</span>
<span class="sd">    causes a positive output from the PID. A negative direction causes feedback in the opposing direction. This is the</span>
<span class="sd">    default and should be selected for most systems.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">NEGATIVE</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">POSITIVE</span> <span class="o">=</span> <span class="kc">True</span></div>



<div class="viewcode-block" id="PidController">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">PidController</span><span class="p">(</span><span class="n">Labnode</span><span class="p">):</span>  <span class="c1"># pylint: disable=too-many-public-methods</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Labnode PID controller. This is the API to configure and control the Labnode.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__DEVICE_IDENTIFIER</span> <span class="o">=</span> <span class="n">DeviceIdentifier</span><span class="o">.</span><span class="n">PID</span>

<div class="viewcode-block" id="PidController.device_identifier">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.device_identifier">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">device_identifier</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DeviceIdentifier</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The device identifier used to identify the device type&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__DEVICE_IDENTIFIER</span></div>


    <span class="n">_RAW_TO_UNIT</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">PidFunctionID</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># We need to truncate to 100 %rH according to the datasheet.</span>
        <span class="c1"># The datasheet is *wrong* about the conversion formula. Slightly wrong, but wrong nonetheless.</span>
        <span class="c1"># They are &quot;off by 1&quot; with the conversion of the 16 bit result. They divide by 2**16 but should divide by</span>
        <span class="c1"># (2**16 - 1). Most likely this was done for performance reason and acceptable.</span>
        <span class="c1"># Return Kelvin</span>
        <span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_BOARD_TEMPERATURE</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span>
            <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;175.72&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">16</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;226.3&quot;</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;1.00&quot;</span><span class="p">)),</span>
        <span class="c1"># We need to truncate to 100 %rH according to the datasheet.</span>
        <span class="c1"># The datasheet is *wrong* about the conversion formula. Slightly wrong, but wrong nonetheless.</span>
        <span class="c1"># They are &quot;off by 1&quot; with the conversion of the 16 bit result. They divide by 2**16 but should divide by</span>
        <span class="c1"># (2**16 - 1). Most likely this was done for performance reason and acceptable.</span>
        <span class="c1"># Return %rH (above liquid water), rH values below 0°C need to be compensated.</span>
        <span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_HUMIDITY</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span>
            <span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">125</span> <span class="o">*</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">16</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">100</span><span class="p">)),</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="p">)</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;1.00&quot;</span><span class="p">)),</span>
        <span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_MAC_ADDRESS</span><span class="p">:</span> <span class="nb">bytearray</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">_RAW_TO_UNIT_11</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">PidFunctionID</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_BOARD_TEMPERATURE</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;273.15&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;1.00&quot;</span><span class="p">)),</span>
        <span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_HUMIDITY</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;1.00&quot;</span><span class="p">)),</span>
        <span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_MAC_ADDRESS</span><span class="p">:</span> <span class="nb">bytearray</span><span class="p">,</span>
    <span class="p">}</span>

<div class="viewcode-block" id="PidController.__init__">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connection</span><span class="p">:</span> <span class="n">Connection</span><span class="p">,</span> <span class="n">api_version</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a pid controller. The API version is required to automatically adapt the different api versions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        connection: Connection</span>
<span class="sd">            Either an ethernet or a serial connection</span>
<span class="sd">        api_version:</span>
<span class="sd">            The api version as enumerated by the connection</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">connection</span><span class="p">,</span> <span class="n">api_version</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__raw_to_unit</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">PidFunctionID</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">PidController</span><span class="o">.</span><span class="n">_RAW_TO_UNIT_11</span> <span class="k">if</span> <span class="n">api_version</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="n">PidController</span><span class="o">.</span><span class="n">_RAW_TO_UNIT</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Labnode at </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">__test_for_errors</span><span class="p">(</span><span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test the reply from the device for error messages and raise exceptions accordingly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        result: dict</span>
<span class="sd">            A dict containing key value pairs of PidFunctionIDs and the results as returned by the device</span>
<span class="sd">        key</span>
<span class="sd">            The key to be tested for errors</span>

<span class="sd">        Raises</span>
<span class="sd">        -------</span>
<span class="sd">        TypeError</span>
<span class="sd">            If the key is not found in the dict, we will raise a TypeError</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># We have a setter</span>
            <span class="n">status</span> <span class="o">=</span> <span class="n">ErrorCode</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="n">ErrorCode</span><span class="o">.</span><span class="n">INVALID_MODE</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">InvalidModeError</span><span class="p">(</span>
                    <span class="s2">&quot;The controller is set to the wrong mode. Disable it to set the output, enable it to set the input&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="n">ErrorCode</span><span class="o">.</span><span class="n">INVALID_COMMAND</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The command &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; is invalid&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="n">ErrorCode</span><span class="o">.</span><span class="n">INVALID_PARAMETER_TYPE</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid value for request </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="n">ErrorCode</span><span class="o">.</span><span class="n">NOT_INITIALIZED</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PidNotInitializedError</span><span class="p">(</span>
                    <span class="s2">&quot;PID controller not initialized, Make sure kp, ki, kd and the setpoint is set&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="n">ErrorCode</span><span class="o">.</span><span class="n">NOT_IMPLEMENTED</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">FunctionNotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The function </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> is not implemented&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="n">ErrorCode</span><span class="o">.</span><span class="n">DEPRECATED</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The function </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> is deprecated&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>

        <span class="c1"># If the controller cannot parse the packet, it will answer with an INVALID_FORMAT error</span>
        <span class="c1"># and throw away the input, so we do not get a reply to our request.</span>
        <span class="k">if</span> <span class="n">PidFunctionID</span><span class="o">.</span><span class="n">INVALID_FORMAT</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidFormatError</span><span class="p">(</span><span class="s2">&quot;Invalid data format. Check the datatype&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="c1"># This can only happen, if another process is using the same sequence_number</span>
            <span class="k">raise</span> <span class="n">InvalidReplyError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid reply received for request id </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">. Is someone using the same socket? Data: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">__send_single_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_multi_request</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="p">{</span>
                <span class="n">key</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__test_for_errors</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">key</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ErrorCode</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

<div class="viewcode-block" id="PidController.send_multi_request">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.send_multi_request">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">send_multi_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">PidFunctionID</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Send one or more requests to the device.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If an unknown function id was sent and `response_expected` was set to True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_version</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="c1"># We need to rewrite some function ids</span>
            <span class="k">if</span> <span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_HUMIDITY</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_HUMIDITY</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_HUMIDITY</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_BOARD_TEMPERATURE</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_BOARD_TEMPERATURE</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_BOARD_TEMPERATURE</span><span class="p">]</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">send_request</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">response_expected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_version</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="c1"># We need to rewrite some function ids</span>
            <span class="k">if</span> <span class="o">-</span><span class="mi">21</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_HUMIDITY</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="o">-</span><span class="mi">21</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">result</span><span class="p">[</span><span class="o">-</span><span class="mi">21</span><span class="p">]</span>
            <span class="k">if</span> <span class="o">-</span><span class="mi">20</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_BOARD_TEMPERATURE</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">result</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="n">PidFunctionID</span><span class="p">(</span><span class="n">key</span><span class="p">):</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="c1"># Raised by PidFunctionID(key)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Received unknown function id in data: </span><span class="si">%(data)s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="PidController.get_software_version">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_software_version">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_software_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the firmware version running on the device. The response is a tuple of ints, that represents the version</span>
<span class="sd">        number.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Tuple of int</span>
<span class="sd">            The version number</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_SOFTWARE_VERSION</span><span class="p">)</span></div>


<div class="viewcode-block" id="PidController.get_hardware_version">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_hardware_version">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_hardware_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the hardware revision of the device. The response is a tuple of ints, that represents the version number.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Tuple of int</span>
<span class="sd">            The revision number</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_HARDWARE_VERSION</span><span class="p">)</span></div>


<div class="viewcode-block" id="PidController.get_serial">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_serial">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_serial</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the serial number of the device.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The serial number of the device</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_SERIAL_NUMBER</span><span class="p">)</span></div>


<div class="viewcode-block" id="PidController.get_device_temperature">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_device_temperature">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_device_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Decimal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Query the temperature of the onboard sensor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Decimal</span>
<span class="sd">            The temperature of the onboard sensor in Kelvin</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_BOARD_TEMPERATURE</span><span class="p">)</span></div>


<div class="viewcode-block" id="PidController.get_humidity">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_humidity">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_humidity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Decimal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the humidity as read by the onboard sensor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Decimal</span>
<span class="sd">            The humidity in %rH</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_HUMIDITY</span><span class="p">)</span></div>


<div class="viewcode-block" id="PidController.get_mac_address">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_mac_address">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_mac_address</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytearray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the MAC address used by the ethernet port.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bytearray</span>
<span class="sd">            An array of length 6 which contains the MAC</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_MAC_ADDRESS</span><span class="p">)</span></div>


<div class="viewcode-block" id="PidController.set_mac_address">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.set_mac_address">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_mac_address</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mac</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">bytearray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the MAC address used by the ethernet port.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mac: bytearray or tuple of int</span>
<span class="sd">            The MAC address as a bytearray of length 6</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mac</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span>
        <span class="n">mac</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">mac</span><span class="p">)</span>  <span class="c1"># convert to bytearray, this also makes sure, that all values are in range(0, 256)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send_single_request</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_MAC_ADDRESS</span><span class="p">,</span> <span class="n">mac</span><span class="p">)</span></div>


<div class="viewcode-block" id="PidController.get_uuid">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_uuid">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_uuid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">UUID</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the universally unique identifier of the node.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        UUID</span>
<span class="sd">            The universally unique identifier of the node</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        FunctionNotImplementedError</span>
<span class="sd">            If the firmware version does not support the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_version</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">FunctionNotImplementedError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_UUID</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is only supported in api version &gt;= 0.12.0&quot;</span>
            <span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_UUID</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">UUID</span><span class="p">(</span><span class="nb">bytes</span><span class="o">=</span><span class="nb">bytes</span><span class="p">(</span><span class="n">result</span><span class="p">))</span></div>


<div class="viewcode-block" id="PidController.set_uuid">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.set_uuid">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_uuid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uuid</span><span class="p">:</span> <span class="n">UUID</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the universally unique identifier of the node.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        uuid: UUID</span>
<span class="sd">            The universally unique identifier of the node</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        FunctionNotImplementedError</span>
<span class="sd">            If the firmware version does not support the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_version</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">FunctionNotImplementedError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_UUID</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is only supported in api version &gt;= 0.12.0&quot;</span>
            <span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send_single_request</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_UUID</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">bytes</span><span class="p">))</span></div>


<div class="viewcode-block" id="PidController.get_auto_resume">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_auto_resume">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_auto_resume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Query the node, whether is automatically resumes after a reset (intentionally or unintentionally). If set, the</span>
<span class="sd">        node will return to the same state. If not, the node will always come up as disabled with default settings.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if the node keeps its enabled state after a reset</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_AUTO_RESUME</span><span class="p">)</span></div>


<div class="viewcode-block" id="PidController.set_auto_resume">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.set_auto_resume">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_auto_resume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the controller to automatically load the previous settings and resume its action.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value: bool</span>
<span class="sd">            Set to True to load the node settings on boot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send_single_request</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_AUTO_RESUME</span><span class="p">,</span> <span class="nb">bool</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></div>


<div class="viewcode-block" id="PidController.set_lower_output_limit">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.set_lower_output_limit">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_lower_output_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the minimum output of the DAC in bit values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        limit: int</span>
<span class="sd">            The minimum output value of the DAC</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the limit was out of bounds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send_single_request</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_LOWER_OUTPUT_LIMIT</span><span class="p">,</span> <span class="n">limit</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">InvalidFormatError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid limit&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="kc">None</span></div>


<div class="viewcode-block" id="PidController.get_lower_output_limit">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_lower_output_limit">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_lower_output_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the minimum output value of the DAC.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The minimum output in bit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_LOWER_OUTPUT_LIMIT</span><span class="p">)</span></div>


<div class="viewcode-block" id="PidController.set_upper_output_limit">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.set_upper_output_limit">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_upper_output_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the maximum output of the DAC in bit values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        limit: int</span>
<span class="sd">            The maximum output value of the DAC</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the limit was out of bounds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send_single_request</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_UPPER_OUTPUT_LIMIT</span><span class="p">,</span> <span class="n">limit</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">InvalidFormatError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid limit&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="kc">None</span></div>


<div class="viewcode-block" id="PidController.get_upper_output_limit">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_upper_output_limit">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_upper_output_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the maximum output of the DAC in bit values.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The upper limit for the output DAC</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_UPPER_OUTPUT_LIMIT</span><span class="p">)</span></div>


<div class="viewcode-block" id="PidController.set_timeout">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.set_timeout">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the timeout, that defines when the controller switches to fallback mode. The time is measured in s.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        timeout</span>
<span class="sd">            The timeout in seconds</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">timeout</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send_single_request</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_TIMEOUT</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">timeout</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span></div>


<div class="viewcode-block" id="PidController.get_timeout">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_timeout">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the time, that must pass between updates, before the controller switches to fallback mode.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The time in seconds, that the controller waits between updates</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_TIMEOUT</span><span class="p">))</span> <span class="o">/</span> <span class="mi">1000</span></div>


<div class="viewcode-block" id="PidController.set_dac_gain">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.set_dac_gain">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_dac_gain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enable</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the gain of the DAC to x2. This will increase the output voltage range from 0..5V to 0..10V.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        enable</span>
<span class="sd">            True to enable the gain</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send_single_request</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_GAIN</span><span class="p">,</span> <span class="nb">bool</span><span class="p">(</span><span class="n">enable</span><span class="p">))</span></div>


<div class="viewcode-block" id="PidController.is_dac_gain_enabled">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.is_dac_gain_enabled">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">is_dac_gain_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return True if the DAC output goes from 0-10 V. False if the DAC gain is disabled and the output is 0-5 V.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if the gain is enabled</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_GAIN</span><span class="p">)</span></div>


<div class="viewcode-block" id="PidController.set_pid_feedback_direction">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.set_pid_feedback_direction">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_pid_feedback_direction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feedback</span><span class="p">:</span> <span class="n">FeedbackDirection</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the sign of the pid output. This needs to be adjusted according to the actuator used to</span>
<span class="sd">        control the plant. Typically, it is assumed, that the feedback is negative. For example, when</span>
<span class="sd">        dealing with e.g. temperature control, this means, that if the temperature is too high,</span>
<span class="sd">        an increase in the feedback will increase the cooling action.</span>
<span class="sd">        In short: If set to `FeedbackDirection.NEGATIVE`, a positive error will result in a negative plant response.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        feedback: FeedbackDirection</span>
<span class="sd">            The direction of the controller response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">feedback</span> <span class="o">=</span> <span class="n">FeedbackDirection</span><span class="p">(</span><span class="n">feedback</span><span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send_single_request</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_DIRECTION</span><span class="p">,</span> <span class="n">feedback</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>


<div class="viewcode-block" id="PidController.get_pid_feedback_direction">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_pid_feedback_direction">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_pid_feedback_direction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FeedbackDirection</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the sign of the pid output. If set to `FeedbackDirection.NEGATIVE`, a positive error will result in a</span>
<span class="sd">        negative plant response.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        FeedbackDirection</span>
<span class="sd">            The direction of the controller response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">FeedbackDirection</span><span class="p">(</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_DIRECTION</span><span class="p">))</span></div>


<div class="viewcode-block" id="PidController.set_output">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.set_output">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the output value of the DAC. This function only works, when the controller mode is set to disabled (manual).</span>
<span class="sd">        Use `set_enabled(false)`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value: int</span>
<span class="sd">            The output in bit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send_single_request</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_OUTPUT</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></div>


<div class="viewcode-block" id="PidController.get_output">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_output">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_output</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Queries the output value of the DAC.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The output of the DAC in bit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_OUTPUT</span><span class="p">)</span></div>


<div class="viewcode-block" id="PidController.set_enabled">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.set_enabled">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enabled</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the PID controller to enabled/automatic or disabled/manual mode.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        enabled: bool</span>
<span class="sd">            True to enable the PID controller</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send_single_request</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_ENABLED</span><span class="p">,</span> <span class="nb">bool</span><span class="p">(</span><span class="n">enabled</span><span class="p">))</span></div>


<div class="viewcode-block" id="PidController.is_enabled">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.is_enabled">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">is_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Queries the state of the PID controller.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if the controller is enabled</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_ENABLED</span><span class="p">)</span></div>


    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">__set_kx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function_id</span><span class="p">:</span> <span class="n">PidFunctionID</span><span class="p">,</span> <span class="n">kx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pylint: disable=invalid-name</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the PID K{p,i,d} parameter. The Kp, Ki, Kd parameters are stored in Q16.16 format</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        function_id: PidFunctionID</span>
<span class="sd">            Select which parameter set should be updated</span>
<span class="sd">        kx: int</span>
<span class="sd">            The value of the Kp, Ki or Kd parameter</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        InvalidFormatError</span>
<span class="sd">            If the pid constant was rejected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_version</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">function_id</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_SECONDARY_KP</span><span class="p">,</span>
            <span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_SECONDARY_KI</span><span class="p">,</span>
            <span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_SECONDARY_KD</span><span class="p">,</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="n">FunctionNotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">function_id</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is only supported in api version &gt;= 0.11.0&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send_single_request</span><span class="p">(</span><span class="n">function_id</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">kx</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">InvalidFormatError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid PID constant&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="kc">None</span>

<div class="viewcode-block" id="PidController.set_kp">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.set_kp">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_kp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kp</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">config_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pylint: disable=invalid-name</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the PID Kp parameter. The Kp, Ki, Kd parameters are stored in Q16.16 format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kp: int</span>
<span class="sd">            The PID k_p parameter in Q16.16 format</span>
<span class="sd">        config_id: {0, 1}, default=0</span>
<span class="sd">            The id of the parameter set. The controller supports two pid parameter sets. Either 0 or 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">config_id</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">config_id</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__set_kx</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_KP</span><span class="p">,</span> <span class="n">kp</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__set_kx</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_SECONDARY_KP</span><span class="p">,</span> <span class="n">kp</span><span class="p">)</span></div>


<div class="viewcode-block" id="PidController.get_kp">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_kp">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_kp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the PID Kp parameter. The Kp, Ki, Kd parameters are stored in Q16.16 format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        config_id: {0, 1}, default=0</span>
<span class="sd">            The id of the parameter set. The controller supports two pid parameter sets. Either 0 or 1.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        FunctionNotImplementedError</span>
<span class="sd">            If the firmware version does not support the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">config_id</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">config_id</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_KP</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_version</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_SECONDARY_KP</span><span class="p">)</span>

        <span class="k">raise</span> <span class="n">FunctionNotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_SECONDARY_KP</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is only supported in api version &gt;= 0.11.0&quot;</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PidController.set_ki">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.set_ki">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_ki</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ki</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">config_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pylint: disable=invalid-name</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the PID Ki parameter. The Kp, Ki, Kd parameters are stored in Q16.16 format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ki: int</span>
<span class="sd">            The parameter value in Q16.16 format (32 bit)</span>
<span class="sd">        config_id: {0, 1}, default=0</span>
<span class="sd">            The id of the parameter set. The controller supports two pid parameter sets. Either 0 or 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">config_id</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">config_id</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__set_kx</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_KI</span><span class="p">,</span> <span class="n">ki</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__set_kx</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_SECONDARY_KI</span><span class="p">,</span> <span class="n">ki</span><span class="p">)</span></div>


<div class="viewcode-block" id="PidController.get_ki">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_ki">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_ki</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the PID Ki parameter. The Kp, Ki, Kd parameters are stored in Q16.16 format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        config_id: {0, 1}, default=0</span>
<span class="sd">            The id of the parameter set. The controller supports two pid parameter sets. Either 0 or 1.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        FunctionNotImplementedError</span>
<span class="sd">            If the firmware version does not support the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">config_id</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">config_id</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_KI</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_version</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_SECONDARY_KI</span><span class="p">)</span>

        <span class="k">raise</span> <span class="n">FunctionNotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_SECONDARY_KI</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is only supported in api version &gt;= 0.11.0&quot;</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PidController.set_kd">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.set_kd">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_kd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kd</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">config_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pylint: disable=invalid-name</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the PID Kd parameter. The Kp, Ki, Kd parameters are stored in Q16.16 format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kd: int</span>
<span class="sd">            The parameter value in Q16.16 format (32 bit)</span>
<span class="sd">        config_id: {0, 1}, default=0</span>
<span class="sd">            The id of the parameter set. The controller supports two pid parameter sets. Either 0 or 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">config_id</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">config_id</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__set_kx</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_KD</span><span class="p">,</span> <span class="n">kd</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__set_kx</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_SECONDARY_KD</span><span class="p">,</span> <span class="n">kd</span><span class="p">)</span></div>


<div class="viewcode-block" id="PidController.get_kd">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_kd">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_kd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the PID Kd parameter. The Kp, Ki, Kd parameters are stored in Q16.16 format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        config_id: {0, 1}, default=0</span>
<span class="sd">            The id of the parameter set. The controller supports two pid parameter sets. Either 0 or 1.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        FunctionNotImplementedError</span>
<span class="sd">            If the firmware version does not support the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">config_id</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">config_id</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_KD</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_version</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_SECONDARY_KD</span><span class="p">)</span>

        <span class="k">raise</span> <span class="n">FunctionNotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_SECONDARY_KD</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is only supported in api version &gt;= 0.11.0&quot;</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PidController.set_input">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.set_input">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">return_output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the input, which is fed to the PID controller. The value is in Q16.16 format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value: int</span>
<span class="sd">            The input value in Q16.16 format</span>
<span class="sd">        return_output: bool</span>
<span class="sd">            Returns the output of the controller if True</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int or None:</span>
<span class="sd">            Returns the output of the controller if return_output is set</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># We need to send a multi_request, because if return_output is True, we want to get the</span>
        <span class="c1"># output after the input has been set</span>
        <span class="n">request</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_INPUT</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)}</span>
        <span class="k">if</span> <span class="n">return_output</span><span class="p">:</span>
            <span class="n">request</span><span class="p">[</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_OUTPUT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_multi_request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

        <span class="c1"># We need to test for errors, which would normally be done by __send_single_request()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__test_for_errors</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_INPUT</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">return_output</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_OUTPUT</span><span class="p">]</span>

        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="PidController.set_setpoint">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.set_setpoint">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_setpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">config_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the PID setpoint. The value is in Q16.16 format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value: int</span>
<span class="sd">            The setpoint of the PID controller in Q16.16 format.</span>
<span class="sd">        config_id: {0, 1}, default=0</span>
<span class="sd">            The id of the parameter set. The controller supports two pid parameter sets. Either 0 or 1.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        FunctionNotImplementedError</span>
<span class="sd">            If the firmware version does not support the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">config_id</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">config_id</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send_single_request</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_SETPOINT</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_version</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send_single_request</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_SECONDARY_SETPOINT</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">FunctionNotImplementedError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_SECONDARY_SETPOINT</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is only supported in api version &gt;= 0.11.0&quot;</span>
                    <span class="p">)</span>
        <span class="k">except</span> <span class="n">InvalidFormatError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid setpoint&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="kc">None</span></div>


<div class="viewcode-block" id="PidController.get_setpoint">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_setpoint">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_setpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the PID setpoint. The value is in Q16.16 format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        config_id: {0, 1}, default=0</span>
<span class="sd">            The id of the parameter set. The controller supports two pid parameter sets. Either 0 or 1.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The setpoint value for the given config set.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        FunctionNotImplementedError</span>
<span class="sd">            If the firmware version does not support the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">config_id</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">config_id</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_SETPOINT</span><span class="p">)</span>

        <span class="c1"># Only allow the secondary parameter set on API version &gt;=0.11.0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_version</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_SECONDARY_SETPOINT</span><span class="p">)</span>

        <span class="k">raise</span> <span class="n">FunctionNotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_SECONDARY_SETPOINT</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is only supported in api version &gt;= 0.11.0&quot;</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PidController.set_secondary_config">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.set_secondary_config">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_secondary_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the configuration used when running in fallback mode.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        config_id: {0, 1}</span>
<span class="sd">            The configuration to be used. The controller supports two pid parameter sets. Either 0 or 1.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        FunctionNotImplementedError</span>
<span class="sd">            If the firmware version does not support the request.</span>
<span class="sd">        InvalidFormatError</span>
<span class="sd">            If the config_id is not in {0, 1}.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">config_id</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_version</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">FunctionNotImplementedError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_SECONDARY_PID_PARAMETER_SET</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is only supported in api version &gt;= 0.11.0&quot;</span>
            <span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send_single_request</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_SECONDARY_PID_PARAMETER_SET</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">config_id</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">InvalidFormatError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid configuration set. Use either 0 or 1.&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="kc">None</span></div>


<div class="viewcode-block" id="PidController.get_secondary_config">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_secondary_config">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_secondary_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the configuration id used when running in fallback mode.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The configuration used, when running in fallback mode. The controller supports two pid parameter sets.</span>
<span class="sd">            Either 0 or 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_version</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">FunctionNotImplementedError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_SECONDARY_PID_PARAMETER_SET</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is only supported in api version &gt;= 0.11.0&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_SECONDARY_PID_PARAMETER_SET</span><span class="p">)</span></div>


<div class="viewcode-block" id="PidController.set_secondary_pid_update_interval">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.set_secondary_pid_update_interval">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_secondary_pid_update_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the update interval, when running in fallback mode using the secondary PID settings.</span>
<span class="sd">        The Controller will feed a value from the internal sensor to the secondary PID controller every {value} s.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value: int</span>
<span class="sd">            The update interval in seconds</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send_single_request</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_FALLBACK_UPDATE_INTERVAL</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">InvalidFormatError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid calibration offset&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="kc">None</span></div>


<div class="viewcode-block" id="PidController.get_secondary_pid_update_interval">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_secondary_pid_update_interval">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_secondary_pid_update_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The update interval, which is used when running in fallback mode. The return value is in seconds.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float:</span>
<span class="sd">            The number of seconds between updates with the backup sensor when running in fallback mode.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_FALLBACK_UPDATE_INTERVAL</span><span class="p">))</span> <span class="o">/</span> <span class="mi">1000</span></div>


<div class="viewcode-block" id="PidController.reset">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.reset">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resets the device. This will trigger a hardware reset.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send_single_request</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">RESET</span><span class="p">)</span></div>


<div class="viewcode-block" id="PidController.reset_settings">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.reset_settings">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">reset_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resets the device to default values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send_single_request</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">RESET_SETTINGS</span><span class="p">)</span></div>


<div class="viewcode-block" id="PidController.set_serial">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.set_serial">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_serial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">serial</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the serial number of the device</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        serial: int</span>
<span class="sd">            The serial number. Maximum: 4294967295 (32 bit)</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the serial number is not valid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send_single_request</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">SET_SERIAL_NUMBER</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">serial</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">InvalidFormatError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid serial number&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="kc">None</span></div>


<div class="viewcode-block" id="PidController.get_active_connection_count">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_active_connection_count">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_active_connection_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the number of open sockets.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The number of sockets</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        FunctionNotImplementedError</span>
<span class="sd">            If the firmware version does not support the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_version</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">FunctionNotImplementedError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_ACTIVE_CONNECTION_COUNT</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is only supported in api version &gt;= 0.11.0&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by_function_id</span><span class="p">(</span><span class="n">PidFunctionID</span><span class="o">.</span><span class="n">GET_ACTIVE_CONNECTION_COUNT</span><span class="p">)</span></div>


<div class="viewcode-block" id="PidController.get_by_function_id">
<a class="viewcode-back" href="../../modules.html#labnode_async.PidController.get_by_function_id">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_by_function_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function_id</span><span class="p">:</span> <span class="n">PidFunctionID</span> <span class="o">|</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Query a value by function id, instead of calling the named function.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        function_id: PidFunctionID or int</span>
<span class="sd">            The function to query</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Any</span>
<span class="sd">            The result of the query.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        InvalidCommandError</span>
<span class="sd">            If the function id was given as an integer and is unknown</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">function_id</span> <span class="o">=</span> <span class="n">PidFunctionID</span><span class="p">(</span><span class="n">function_id</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidCommandError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Command </span><span class="si">{</span><span class="n">function_id</span><span class="si">}</span><span class="s2"> is invalid.&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="kc">None</span>
        <span class="k">assert</span> <span class="n">function_id</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span>  <span class="c1"># all getter have negative ids</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send_single_request</span><span class="p">(</span><span class="n">function_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">function_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__raw_to_unit</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__raw_to_unit</span><span class="p">[</span><span class="n">function_id</span><span class="p">](</span><span class="n">result</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>
</div>

</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">labnode_async v0.16.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">labnode_async.pid_controller</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2022, Patrick Baus.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
  </body>
</html>